<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>How to polyfill the browser-native datalist autocomplete functionality | Go Make Things</title>
		<meta name="description" content="Yesterday, I showed you a 100% browser-native, JavaScript-free way to add autocomplete functionality to your site.
Unfortunately, it only works in Chrome, Firefox, and IE11 and up. No support for Safari or Opera.
Today, let&rsquo;s look at how to polyfill support back to IE9.
Prepping for older browsers Some browsers, like Safari, don&rsquo;t support datalist but keep it hidden. Others, like IE9, remove the option elements and display all of the text inside them below your field.">
		

		
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@ChrisFerdinandi">
		<meta property="og:url" content="/how-to-polyfill-the-browser-native-datalist-autocomplete-functionality/">
		<meta property="og:title" content="How to polyfill the browser-native datalist autocomplete functionality">
		<meta property="og:description" content="Yesterday, I showed you a 100% browser-native, JavaScript-free way to add autocomplete functionality to your site.
Unfortunately, it only works in Chrome, Firefox, and IE11 and up. No support for Safari or Opera.
Today, let&rsquo;s look at how to polyfill support back to IE9.
Prepping for older browsers Some browsers, like Safari, don&rsquo;t support datalist but keep it hidden. Others, like IE9, remove the option elements and display all of the text inside them below your field.">
		

		
		
		<link rel="shortcut icon" href="https://gomakethings.com/img/favicon.ico">
		<link rel="icon" sizes="16x16 32x32" href="https://gomakethings.com/img/favicon.ico">

		
		
		<link rel="alternate" type="application/rss+xml" title="Go Make Things RSS Feed" href="https://gomakethings.com/feed/index.xml">
		<link rel="feed" type="application/rss+xml" title="Go Make Things RSS Feed" href="https://gomakethings.com/feed/index.xml">

		
		<style type="text/css">
			/*! gmt v1.16.0 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/go-make-things | Open Source Credits: https://github.com/toddmotto/fluidvids, http://prismjs.com, https://github.com/filamentgroup/loadJS/, https://github.com/filamentgroup/loadCSS, https://github.com/bramstein/fontfaceobserver */
@-webkit-viewport{width:device-width;zoom:1}@-moz-viewport{width:device-width;zoom:1}@-ms-viewport{width:device-width;zoom:1}@-o-viewport{width:device-width;zoom:1}@viewport{width:device-width;zoom:1}.link-block-styled,a,button,input,label,select,summary,textarea{-ms-touch-action:manipulation;touch-action:manipulation}*,:after,:before{box-sizing:border-box}html{overflow-y:scroll;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}body{margin:0}article,aside,cite,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}summary{display:list-item}audio,canvas,progress,video{display:inline-block}progress{vertical-align:baseline}audio:not([controls]){display:none;height:0}img,video{height:auto}embed,iframe,img,object,video{max-width:100%}img{border-style:none;-ms-interpolation-mode:bicubic}svg:not(:root){overflow:hidden}figure{margin:0}[tabindex="-1"]:focus{outline:none}.container{margin-left:auto;margin-right:auto;max-width:38em;width:88%}.container-large{max-width:60em}.row{margin-left:-1.4%;margin-right:-1.4%}.grid-fourth,.grid-half,.grid-third,.grid-three-fourths,.grid-two-thirds{float:left;padding-left:1.4%;padding-right:1.4%;width:100%}.grid-flip{float:right}@media (min-width:38em){.grid-fourth{width:25%}.grid-third{width:33.33333%}.grid-half{width:50%}.grid-two-thirds{width:66.66667%}.grid-three-fourths{width:75%}.offset-fourth{margin-left:25%}.offset-third{margin-left:33.33333%}.offset-half{margin-left:50%}.offset-two-thirds{margin-left:66.66667%}.offset-three-fourths{margin-left:75%}}body{background:#fff;border-top:.5em solid #e5e5e5;color:#272727;font-family:Georgia,serif;font-size:112.5%;line-height:1.5;overflow-x:hidden}.fonts-loaded body{font-family:PT Serif,serif}@media (min-width:38em){body{line-height:1.5625em}}p{margin:0 0 1.5625em}.link-block-styled,a{background-color:transparent;color:#08c;text-decoration:underline;-webkit-text-decoration-skip:ink;text-decoration-skip:ink;text-decoration-skip-ink:auto;word-wrap:break-word}.link-block-styled:active,.link-block-styled:hover,.link-block:hover .link-block-styled,a:active,a:hover{outline:0}.link-block-styled:active,.link-block-styled:focus,.link-block-styled:hover,.link-block:hover .link-block-styled,a:active,a:focus,a:hover{color:#005580}.link-block-styled:visited,a:visited{color:purple}.link-no-underline,.nav-secondary .link-block-styled,.nav-secondary a{text-decoration:none}.link-block:hover .nav-secondary .link-block-styled,.link-no-underline:active,.link-no-underline:focus,.link-no-underline:hover,.nav-secondary .link-block-styled:active,.nav-secondary .link-block-styled:focus,.nav-secondary .link-block-styled:hover,.nav-secondary .link-block:hover .link-block-styled,.nav-secondary a:active,.nav-secondary a:focus,.nav-secondary a:hover{text-decoration:underline}.link-plain,.link-plain:visited{color:#272727;text-decoration:none}.link-plain:active,.link-plain:focus,.link-plain:hover{color:#08c}.link-block.link-block-styled,a.link-block{color:#272727;display:block;text-decoration:none}ol,ul{margin:0 0 1.5625em 2em;padding:0}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}li{margin-bottom:.5em}@media (min-width:38em){li{margin-bottom:.25em}}.list-spaced li{margin-bottom:1em}@media (min-width:38em){.list-spaced li{margin-bottom:.6875em}}dd,dl{margin:0;padding:0}dd{margin-bottom:1.5625em}dt{font-weight:700}.list-unstyled{margin-left:0;list-style:none}.list-inline{list-style:none;margin-left:-.5em;margin-right:-.5em;padding:0}.list-inline li{display:inline-block;margin-left:.5em;margin-right:.5em}@media (max-width:38em){.list-inline.list-inline-responsive li{display:block}}.list-inline-spaced{margin-left:-1.3125em;margin-right:-1.3125em}.list-inline-spaced li{display:inline-block;margin-left:1.3125em;margin-right:1.3125em}h1,h2,h3,h4,h5,h6{font-weight:700;line-height:1.2;margin:0 0 1em;padding:1em 0 0;word-wrap:break-word}.h1,h1{font-size:1.5em;padding-top:.5em}@media (min-width:38em){.h1,h1{font-size:1.75em}}.h2,h2{font-size:1.3125em}.h3,h3{font-size:1.1875em}.h4,.h5,.h6,h4,h5,h6{font-size:1em}.h4,h4{text-transform:uppercase}hr{border:0;border-top:1px solid #e5e5e5;border-bottom:0 solid transparent;box-sizing:content-box;margin:2em auto;overflow:visible}.line-secondary{width:50%}.line-clear{border-top-color:transparent}.line-heading{position:relative}.line-heading:after{background-color:#fff;content:attr(data-heading);font-weight:700;left:50%;padding:0 1em;position:absolute;top:-1em;text-align:center;-webkit-transform:translate(-50%);transform:translate(-50%);width:70%}@media (min-width:28em){.line-heading[data-heading-small]:after{content:attr(data-heading-small)}}@media (min-width:38em){.line-heading[data-heading-medium]:after{content:attr(data-heading-medium)}}@media (min-width:60em){.line-heading[data-heading-large]:after{content:attr(data-heading-large)}}b,strong{font-weight:inherit;font-weight:bolder}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}dfn{font-style:italic}mark{background:#fbf9c9;color:#272727}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}blockquote{border-left:.25em solid #e5e5e5;font-style:italic;margin:0 0 1.5625em;padding-left:1em;padding-right:1em}blockquote cite{color:gray;font-size:.9375em;padding-top:1em}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:""}code,kbd,pre,samp{font-family:Menlo,Monaco,Courier New,monospace;font-size:.875em}code{color:#d14;padding:.25em;word-wrap:break-word}pre{background-color:#f7f7f7;display:block;line-height:1.5;margin:0 0 1.5625em;overflow:auto;padding:.8125em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;white-space:pre-wrap;word-break:break-all}pre code{background-color:transparent;border:0;color:inherit;font-size:1em;padding:0}@media screen{.chroma .err,.chroma .il,.chroma .kc,.chroma .m,.chroma .mb,.chroma .mf,.chroma .mh,.chroma .mi,.chroma .mo,.chroma .no,.chroma .nt,.chroma .py,.chroma .ss{color:#905}.chroma .k,.chroma .kd,.chroma .kn,.chroma .kp,.chroma .kr,.chroma .kt,.chroma .nb,.chroma .s{color:#07a}.chroma .dl,.chroma .l,.chroma .ld,.chroma .n,.chroma .na,.chroma .nc,.chroma .ne,.chroma .s1,.chroma .s2,.chroma .sa,.chroma .sb,.chroma .sc,.chroma .se,.chroma .sh,.chroma .si,.chroma .sx{color:#690}.chroma .bp,.chroma .c,.chroma .c1,.chroma .ch,.chroma .cm,.chroma .cp,.chroma .cpf,.chroma .cs,.chroma .nd,.chroma .nl,.chroma .p,.chroma .sd{color:#708090}.chroma .ni,.chroma .o{color:#a67f59;background:hsla(0,0%,100%,.5)}.chroma .fm,.chroma .nf,.chroma .ow{color:#dd4a68}.chroma .nv,.chroma .sr,.chroma .vc,.chroma .vg,.chroma .vi,.chroma .vm{color:#e90}.chroma .nn{opacity:.7}.chroma .ge{font-style:italic}.chroma .gs{font-weight:700}}.btn{background-color:#f7272f;border:.125em solid #f7272f;border-radius:1px;display:inline-block;font-size:.9375em;font-weight:400;line-height:1.2;margin-right:.3125em;margin-bottom:.3125em;padding:.5em .6875em}.btn,.btn:visited{color:#fff}.btn.active,.btn:active,.btn:focus,.btn:hover{background-color:#cb070e;border-color:#cb070e;color:#fff}.btn.link-block-styled,a.btn{text-decoration:none}.btn-secondary{background-color:#343d4d;border-color:#343d4d}.btn-secondary.active,.btn-secondary:active,.btn-secondary:focus,.btn-secondary:hover{background-color:#15191f;border-color:#15191f}.btn-tertiary{background-color:#08c;border-color:#08c}.btn-tertiary.active,.btn-tertiary:active,.btn-tertiary:focus,.btn-tertiary:hover{background-color:#005580;border-color:#005580}.btn.active,.btn:active{box-shadow:inset 0 .15625em .25em rgba(0,0,0,.15),0 1px .15625em rgba(0,0,0,.05);outline:0}.btn.disabled,.btn[disabled]{box-shadow:none;cursor:not-allowed;opacity:.5;pointer-events:none}.btn-large{font-size:1em;line-height:normal;padding:.6875em .9375em}.btn-block,input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{display:block;margin-right:0;padding-right:0;padding-left:0;width:100%}.btn,button,html input[type=button],input[type=reset],input[type=submit]{cursor:pointer;text-align:center;vertical-align:middle;-webkit-appearance:none}.btn:last-child,input.btn{margin-right:0}fieldset,form{margin-bottom:1.5625em}fieldset{border:0;padding:0}label,legend{display:block;font-weight:400;margin:0 0 .3125em;padding:0}button,input,optgroup,select,textarea{color:#555;font:inherit;margin:0;padding:.3125em}button{overflow:visible}button,select{text-transform:none}input,select,textarea{border:1px solid #b8b8b8;display:block;line-height:1.5;margin-bottom:1.1875em;width:100%}@media (min-width:38em){input,select,textarea{line-height:1.5625}}optgroup{font-weight:700}form .button,form button{margin-bottom:1.1875em}textarea{height:12em;overflow:auto}[type=checkbox],[type=image],[type=radio]{cursor:pointer;display:inline-block;height:auto;margin-bottom:.3125em;padding:0;width:auto}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}input:focus,textarea:focus{border-color:rgba(82,168,236,.8);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 .5em rgba(82,168,236,.6);outline:0;outline:thin dotted\9}[type=checkbox]:focus,[type=file]:focus,select:focus{outline:thin dotted;outline:.3125em auto -webkit-focus-ring-color;outline-offset:-.125em}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}.input-inline{display:inline-block;vertical-align:middle;width:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}.input-search{width:85%;padding-left:.9375em;padding-right:2.5em;border-radius:1.3125em;transition:width .3s ease-in}@media (min-width:38em){.input-search{width:65%}}.btn-search{display:inline;color:gray;border:none;background:none;margin-left:-2.5em;margin-bottom:0}.btn-search svg{fill:gray}.btn-search:hover{color:#5a5a5a}.btn-search:hover svg{fill:#5a5a5a}.error{border-color:#e30810}.error-message{color:#e30810;font-style:italic;margin-bottom:1em}.img-border{border:1px solid #ccc}.img-circle{border-radius:50%}.callout,.fluidvids{margin-bottom:1.5625em}.callout{background-color:#f7f7f7;border:1px solid #e5e5e5;padding:1em 1.5em}.aligncenter,.alignleft,.alignnone,.alignright{display:block;text-align:center;margin-left:auto;margin-right:auto}@media (min-width:28em){.alignleft{float:left;margin-right:1em}}@media (min-width:28em){.alignright{float:right;margin-left:1em}}@media (min-width:28em){.alignnone{margin-left:0;margin-right:0}}.wp-caption-text{font-size:.9375em;font-style:italic;color:gray;padding-top:.5em;text-align:center}table{border-collapse:collapse;border-spacing:0;margin-bottom:1.5625em;max-width:100%;width:100%}td,th{text-align:left;padding:.5em}th{border-bottom:.125em solid #e5e5e5;font-weight:700;vertical-align:bottom}td{border-top:1px solid #e5e5e5;vertical-align:top}.table-striped tbody tr:nth-child(odd){background-color:#f7f7f7}@media (max-width:38em){.table-responsive thead{display:none;visibility:hidden}.table-responsive tr{border-top:1px solid #ededed;display:block;padding:.5em}.table-responsive td{border:0;display:block;padding:.25em}.table-responsive td:before{content:attr(data-label);display:block;font-weight:700}}.nav-wrap{padding-top:1em;padding-bottom:.5em;text-align:center}@media (min-width:60em){.nav-wrap{text-align:left}}.logo{display:inline-block;font-size:1.2em;font-weight:700;line-height:1.2;margin-bottom:.3125em;text-decoration:none}@media (min-width:60em){.logo{float:left;margin-bottom:0}}.logo,.logo:visited{color:#272727}.logo:active,.logo:focus,.logo:hover{color:#08c}.logo .icon{height:.8em;width:.8em}.nav{list-style:none;margin:0 -.5em;padding:0}@media (min-width:60em){.nav{text-align:right}}.nav li{display:inline-block;float:none;margin-left:.5em;margin-right:.5em}.nav .link-block-styled,.nav a{color:gray;text-decoration:none}.link-block:hover .nav .link-block-styled,.nav .active .link-block-styled,.nav .active a,.nav .link-block-styled:active,.nav .link-block-styled:focus,.nav .link-block-styled:hover,.nav .link-block:hover .link-block-styled,.nav a:active,.nav a:focus,.nav a:hover{border-bottom:.125em solid #fa7176;color:#272727}.bg-muted{background-color:#f7f7f7}.text-small{font-size:.9375em}.text-large,.text-xlarge{font-size:1.1875em;line-height:1.4}@media (min-width:38em){.text-large,.text-xlarge{font-size:1.3125em}}.text-xlarge{font-size:1.7em}@media (min-width:38em){.text-xlarge{font-size:2em}}.text-muted{color:gray}.btn del,.text-muted-light{color:#b2b2b2}.text-normal{font-weight:400;font-style:normal}.text-center{text-align:center}.text-right{text-align:right}@media (min-width:60em){.text-right-large{text-align:right}}.float-center{float:none;margin-left:auto;margin-right:auto}.no-margin-top{margin-top:0}.no-margin-bottom{margin-bottom:0}.margin-top{margin-top:1.5625em}.margin-bottom{margin-bottom:1.5625em}.error,.margin-bottom-small{margin-bottom:.5em}.margin-bottom-large{margin-bottom:2em}.margin-bottom-negative{margin-bottom:-1.75em}.margin-right{margin-right:.25em}.no-padding-top{padding-top:0}.no-padding-bottom{padding-bottom:0}.padding-top{padding-top:1.5625em}.padding-top-xsmall{padding-top:.25em}.padding-top-small{padding-top:.5em}.padding-top-medium{padding-top:1em}.padding-top-large{padding-top:2em}.padding-top-xlarge{padding-top:3em}.padding-bottom{padding-bottom:1.5625em}.padding-bottom-small{padding-bottom:.5em}.padding-bottom-large{padding-bottom:2em}.padding-bottom-xlarge{padding-bottom:3em}.screen-reader{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.screen-reader-focusable:active,.screen-reader-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;white-space:normal;width:auto}.tarpit,[hidden],template{display:none;visibility:hidden}.clearfix:after,.clearfix:before,.container:after,.container:before,.nav-wrap:after,.nav-wrap:before,.row:after,.row:before{display:table;content:" "}.clearfix:after,.container:after,.nav-wrap:after,.row:after{clear:both}@media print{*{background:transparent!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}@page{margin:.5cm}.link-block-styled,.link-block-styled:visited,a,a:visited{text-decoration:underline}[href].link-block-styled:after,a[href]:after{content:" (" attr(href) ")"}[href^="#"].link-block-styled:after,a[href^="#"]:after{content:""}h1,h2,h3,p{orphans:3;widows:3}h1,h2,h3{page-break-after:avoid}blockquote,pre{border-color:#999;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}}
		</style>

		
		<script>
			/*! gmt v1.16.0 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/go-make-things | Open Source Credits: https://github.com/toddmotto/fluidvids, http://prismjs.com, https://github.com/filamentgroup/loadJS/, https://github.com/filamentgroup/loadCSS, https://github.com/bramstein/fontfaceobserver */
function loadCSS(t,e,n){"use strict";function o(){for(var e,r=0;r<a.length;r++)a[r].href&&a[r].href.indexOf(t)>-1&&(e=!0);e?i.media=n||"all":setTimeout(o)}var i=window.document.createElement("link"),r=e||window.document.getElementsByTagName("script")[0],a=window.document.styleSheets;return i.rel="stylesheet",i.href=t,i.media="only x",r.parentNode.insertBefore(i,r),o(),i}!(function(){"use strict";function t(t){f.push(t),1==f.length&&l()}function e(){for(;f.length;)f[0](),f.shift()}function n(t){this.a=u,this.b=void 0,this.f=[];var e=this;try{t((function(t){r(e,t)}),(function(t){a(e,t)}))}catch(t){a(e,t)}}function o(t){return new n(function(e,n){n(t)})}function i(t){return new n(function(e){e(t)})}function r(t,e){if(t.a==u){if(e==t)throw new TypeError;var n=!1;try{var o=e&&e.then;if(null!=e&&"object"==typeof e&&"function"==typeof o)return void o.call(e,(function(e){n||r(t,e),n=!0}),(function(e){n||a(t,e),n=!0}))}catch(e){return void(n||a(t,e))}t.a=0,t.b=e,s(t)}}function a(t,e){if(t.a==u){if(e==t)throw new TypeError;t.a=1,t.b=e,s(t)}}function s(e){t((function(){if(e.a!=u)for(;e.f.length;){var t=e.f.shift(),n=t[0],o=t[1],i=t[2],t=t[3];try{0==e.a?i("function"==typeof n?n.call(void 0,e.b):e.b):1==e.a&&("function"==typeof o?i(o.call(void 0,e.b)):t(e.b))}catch(e){t(e)}}}))}function c(t){return new n(function(e,n){var o=0,r=[];0==t.length&&e(r);for(var a=0;a<t.length;a+=1)i(t[a]).c(function(n){return function(i){r[n]=i,(o+=1)==t.length&&e(r)}}(a),n)})}function d(t){return new n(function(e,n){for(var o=0;o<t.length;o+=1)i(t[o]).c(e,n)})}var l,f=[];l=function(){setTimeout(e)};var u=2;n.prototype.g=function(t){return this.c(void 0,t)},n.prototype.c=function(t,e){var o=this;return new n(function(n,i){o.f.push([t,e,n,i]),s(o)})},window.Promise||(window.Promise=n,window.Promise.resolve=i,window.Promise.reject=o,window.Promise.race=d,window.Promise.all=c,window.Promise.prototype.then=n.prototype.c,window.Promise.prototype.catch=n.prototype.g)})(),(function(){function t(t,e){d?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function e(t){document.body?t():d?document.addEventListener("DOMContentLoaded",t):document.attachEvent("onreadystatechange",(function(){"interactive"!=document.readyState&&"complete"!=document.readyState||t()}))}function n(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function o(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function i(t){var e=t.a.offsetWidth,n=e+100;return t.f.style.width=n+"px",t.c.scrollLeft=n,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,!0)}function r(e,n){function o(){var t=r;i(t)&&null!==t.a.parentNode&&n(t.g)}var r=e;t(e.b,o),t(e.c,o),i(e)}function a(t,e){var n=e||{};this.family=t,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}function s(){if(null===f){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}f=""!==t.style.font}return f}function c(t,e){return[t.style,t.weight,s()?t.stretch:"","100px",e].join(" ")}var d=!!document.addEventListener,l=null,f=null,u=!!window.FontFace;a.prototype.load=function(t,i){var a=this,s=t||"BESbswy",d=i||3e3,f=(new Date).getTime();return new Promise(function(t,i){if(u){var h=new Promise(function(t,e){function n(){(new Date).getTime()-f>=d?e():document.fonts.load(c(a,a.family),s).then((function(e){1<=e.length?t():setTimeout(n,25)}),(function(){e()}))}n()}),p=new Promise(function(t,e){setTimeout(e,d)});Promise.race([p,h]).then((function(){t(a)}),(function(){i(a)}))}else e((function(){function e(){var e;(e=-1!=w&&-1!=v||-1!=w&&-1!=y||-1!=v&&-1!=y)&&((e=w!=v&&w!=y&&v!=y)||(null===l&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=l&&(w==g&&v==g&&y==g||w==b&&v==b&&y==b||w==x&&v==x&&y==x)),e=!e),e&&(null!==T.parentNode&&T.parentNode.removeChild(T),clearTimeout(E),t(a))}function u(){if((new Date).getTime()-f>=d)null!==T.parentNode&&T.parentNode.removeChild(T),i(a);else{var t=document.hidden;!0!==t&&void 0!==t||(w=h.a.offsetWidth,v=p.a.offsetWidth,y=m.a.offsetWidth,e()),E=setTimeout(u,50)}}var h=new n(s),p=new n(s),m=new n(s),w=-1,v=-1,y=-1,g=-1,b=-1,x=-1,T=document.createElement("div"),E=0;T.dir="ltr",o(h,c(a,"sans-serif")),o(p,c(a,"serif")),o(m,c(a,"monospace")),T.appendChild(h.a),T.appendChild(p.a),T.appendChild(m.a),document.body.appendChild(T),g=h.a.offsetWidth,b=p.a.offsetWidth,x=m.a.offsetWidth,u(),r(h,(function(t){w=t,e()})),o(h,c(a,'"'+a.family+'",sans-serif')),r(p,(function(t){v=t,e()})),o(p,c(a,'"'+a.family+'",serif')),r(m,(function(t){y=t,e()})),o(m,c(a,'"'+a.family+'",monospace'))}))})},window.FontFaceObserver=a,window.FontFaceObserver.prototype.check=window.FontFaceObserver.prototype.load=a.prototype.load,"undefined"!=typeof module&&(module.exports=window.FontFaceObserver)})();var getCookie=function(t){var e="; "+document.cookie,n=e.split("; "+t+"=");if(2==n.length)return n.pop().split(";").shift()};!(function(){var t="https://fonts.googleapis.com/css?family=PT+Serif:400,400i,700,700i";if(getCookie("fontsLoaded"))loadCSS(t),document.documentElement.className+=" fonts-loaded";else{loadCSS(t);new FontFaceObserver("PT Serif").load().then((function(){var t=new Date(+new Date+6048e5).toUTCString();document.cookie="fontsLoaded=true; expires="+t,document.documentElement.className+=" fonts-loaded"}))}})();
		</script>
	</head>

	<body class="type-articles page-single" id="page-e3817da549a84b10b6a42fc41358ea6a">

		<div class="container container-large">

	
	<a class="screen-reader screen-reader-focusable" href="#main">Skip to main content</a>

	
	<a class="screen-reader screen-reader-focusable" href="mailto:&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;?subject=Go%20Make%20Things:%20Accessibility%20Feedback">Accessibility Feedback</a>

</div>

		<header class="container container-large margin-bottom-large">
	<nav class="nav-wrap">
		<a class="logo" href="https://gomakethings.com">
			<svg xmlns="http://www.w3.org/2000/svg" style="height:.8em;width:.8em" viewBox="0 0 16 16"><title></title><path fill="currentColor" d="M14 9v2.066c-1.258 1.285-3.016 2.526-5 2.852V8.001h3v-1L9 5.83A3.001 3.001 0 0 0 8 .001 3 3 0 0 0 7 5.83L4 7.001v1h3v5.917c-1.984-.326-3.742-1.567-5-2.852V9H0v1c0 2 4 6 8 6s8-4 8-6V9h-2zM9 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>
			Go Make Things
		</a>
		<div class="nav-menu" id="nav-menu">
			<ul class="nav">
				<li><a href="https://gomakethings.com/about">About</a></li><li class="active" ><a href="https://gomakethings.com/articles">Daily Tips</a></li><li><a href="https://gomakethings.com/resources">Learn JS</a></li>
			</ul>
			
		</div>
	</nav>
</header>

		<main id="main" tabindex="-1">

			<div class="container">

	<article>

		<header>

			<aside class="text-muted">
				<time datetime="2018-06-22 10:30:00 -0400 EDT" pubdate>June 22, 2018</time>
			</aside>

			<h1 class="no-padding-top">
				How to polyfill the browser-native datalist autocomplete functionality
			</h1>

		</header>

		

<p>Yesterday, I showed you <a href="https://gomakethings.com/how-to-create-a-form-input-autocomplete-without-a-library-or-framework/">a 100% browser-native, JavaScript-free way to add autocomplete functionality</a> to your site.</p>

<p>Unfortunately, it only works in Chrome, Firefox, and IE11 and up. No support for Safari or Opera.</p>

<p>Today, let&rsquo;s look at how to polyfill support back to IE9.</p>

<h2 id="prepping-for-older-browsers">Prepping for older browsers</h2>

<p>Some browsers, like Safari, don&rsquo;t support <code>datalist</code> but keep it hidden. Others, like IE9, remove the <code>option</code> elements and display all of the text inside them below your field.</p>

<p>Let&rsquo;s do two things to fix this. First, we&rsquo;ll use some CSS to make sure the <code>datalist</code> stays hidden.</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">datalist</span> <span class="p">{</span>
	<span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>
<p>Next, if we wrap our <code>option</code> elements in a <code>select</code> element, IE9 won&rsquo;t strip them out, <em>and</em> the <code>datalist</code> will still work as expected in modern, supporting browsers.</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">datalist</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">select</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">option</span><span class="p">&gt;</span>Alabama<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">option</span><span class="p">&gt;</span>Alaska<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">option</span><span class="p">&gt;</span>Arizona<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
		...
	<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">datalist</span><span class="p">&gt;</span></code></pre></div>
<h2 id="checking-for-browser-support">Checking for browser support</h2>

<p>Now we&rsquo;re ready to start coding. Let&rsquo;s first setup a function to hold our polyfill.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">autocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

	<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>The very first thing we want to do is check if the browser supports <code>datalist</code> natively. If so, we won&rsquo;t run our polyfill.</p>

<p>We&rsquo;ll test this by checking to see if <code>list</code> exists on <code>input</code> elements, and if <code>datalist</code> an element in the <code>window</code> (shoutout to <a href="https://github.com/thgreasi/datalist-polyfill">Thodoris Greasidis</a> for this).</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">autocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

	<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

	<span class="c1">// Check if datalist is supported
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">supportsDatalist</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s1">&#39;list&#39;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;datalist&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">HTMLDataListElement</span><span class="p">);</span>
	<span class="p">};</span>

	<span class="c1">// Don&#39;t run if datalist is supported natively
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">supportsDatalist</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>Cool, now we&rsquo;re ready to really do this.</p>

<h2 id="creating-a-map-of-options">Creating a map of options</h2>

<p>Now, let&rsquo;s grab all of the <code>input</code> elements on the page that have a <code>[list]</code> attribute. If there aren&rsquo;t any on the page, we&rsquo;ll quit.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">autocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

	<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

	<span class="c1">// Check if datalist is supported
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">supportsDatalist</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s1">&#39;list&#39;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;datalist&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">HTMLDataListElement</span><span class="p">);</span>
	<span class="p">};</span>

	<span class="c1">// Don&#39;t run if datalist is supported natively
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">supportsDatalist</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Get all autocomplete fields
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">autocompletes</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;input[list]&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">autocompletes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>Now we&rsquo;re ready to create that map of options. We&rsquo;ll pass our <code>autocompletes</code> fields into a <code>setup()</code> function.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">autocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

	<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

	<span class="c1">// Check if datalist is supported
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">supportsDatalist</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s1">&#39;list&#39;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;datalist&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">HTMLDataListElement</span><span class="p">);</span>
	<span class="p">};</span>

	<span class="c1">// Don&#39;t run if datalist is supported natively
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">supportsDatalist</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Get all autocomplete fields
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">autocompletes</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;input[list]&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">autocompletes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Setup the DOM
</span><span class="c1"></span>	<span class="nx">setup</span><span class="p">(</span><span class="nx">autocompletes</span><span class="p">);</span>

<span class="p">};</span>
</code></pre></div>
<p>For each autocomplete field, we want to get the corresponding <code>datalist</code>.</p>

<p>To do that, we&rsquo;ll get the <code>list</code> attribute from the field, and pass it into <code>getElementById()</code>. Then, we&rsquo;ll use <code>querySelectorAll()</code> to search for <code>option</code> elements <em>just</em> within that element.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">autocompletes</span><span class="p">)</span> <span class="p">{</span>

	<span class="nx">autocompletes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">autocomplete</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">datalist</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">autocomplete</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">datalist</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

		<span class="c1">// Get datalist options
</span><span class="c1"></span>		<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">datalist</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="p">});</span>

<span class="p">};</span>
</code></pre></div>
<p>Now we want to create an array with our option values. We&rsquo;ll pass the NodeList of <code>option</code> elements through <code>Array.from()</code> to convert it to an array, and then use the <code>Array.map()</code> method to create a new array.</p>

<p>Each item in the new <code>optionsMap</code> array will contain the text from the corresponding <code>option</code> element.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">autocompletes</span><span class="p">)</span> <span class="p">{</span>

	<span class="nx">autocompletes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">autocomplete</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">datalist</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">autocomplete</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">datalist</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

		<span class="c1">// Get datalist options
</span><span class="c1"></span>		<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">datalist</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

		<span class="c1">// Create an array of available options
</span><span class="c1"></span>		<span class="kd">var</span> <span class="nx">optionsMap</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">options</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
		<span class="p">});</span>

	<span class="p">});</span>

<span class="p">};</span>
</code></pre></div>
<p>Finally, we&rsquo;ll add a new attribute to our <code>input</code>&mdash;<code>[data-list-map]</code>&mdash;with a stringified version of the <code>optionsMap</code> array as it&rsquo;s value.</p>

<p>This will let us quickly and easily get a list of options that we can parse with JavaScript.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">autocompletes</span><span class="p">)</span> <span class="p">{</span>

	<span class="nx">autocompletes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">autocomplete</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">datalist</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">autocomplete</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">datalist</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

		<span class="c1">// Get datalist options
</span><span class="c1"></span>		<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">datalist</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

		<span class="c1">// Create an array of available options
</span><span class="c1"></span>		<span class="kd">var</span> <span class="nx">optionsMap</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">options</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
		<span class="p">});</span>

		<span class="c1">// Save the array to the DOM
</span><span class="c1"></span>		<span class="nx">autocomplete</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;data-list-map&#39;</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">optionsMap</span><span class="p">));</span>

	<span class="p">});</span>

<span class="p">};</span>
</code></pre></div>
<h2 id="detecting-when-the-user-types-in-a-field">Detecting when the user types in a field</h2>

<p>Now, we need to show a list of options when the user types. We&rsquo;ll listen for <code>input</code> events, which fire whenever an input field changes in value.</p>

<p>Since we may have multiple autocomplete fields, we&rsquo;ll <a href="https://gomakethings.com/checking-event-target-selectors-with-event-bubbling-in-vanilla-javascript/">use event delegation to listen to all events in the document and filter out the ones we don&rsquo;t need</a>. We&rsquo;ll create a <code>changeHandler()</code> function to handle this event.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="nx">changeHandler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<p>In our <code>changeHandler()</code> method, we first need to check if the input has the map of options we created in the <code>setup()</code> method. If it doesn&rsquo;t, it&rsquo;s not an autocomplete field and we can bail.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">changeHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// Check if item has an options map
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">optionsMap</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-list-map&#39;</span><span class="p">);</span>

	<span class="c1">// Only run for inputs that have an associated datalist
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">optionsMap</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>Next, we want to convert our string of data back into an array using <code>JSON.parse()</code>.</p>

<p>Then, we can use that data to render a list of options for the user. We&rsquo;ll pass the input and our data into a <code>renderAutocomplete()</code> helper method.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">changeHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// Check if item has an options map
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">optionsMap</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-list-map&#39;</span><span class="p">);</span>

	<span class="c1">// Only run for inputs that have an associated datalist
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">optionsMap</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Convert optionsMap string to an array
</span><span class="c1"></span>	<span class="nx">optionsMap</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">optionsMap</span><span class="p">);</span>

	<span class="nx">renderAutocomplete</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="nx">optionsMap</span><span class="p">);</span>

<span class="p">};</span>
</code></pre></div>
<h2 id="rendering-the-autocomplete-options">Rendering the autocomplete options</h2>

<p>Our <code>optionsMap</code> contains a full list of options, but based on what the user typed, only some of them will be viable choices.</p>

<p>Let&rsquo;s create a new array that only contains potential matches. To do this, we&rsquo;ll use the <code>Array.filter()</code> method on our <code>options</code>.</p>

<p>We want to do a case-insensitive comparison, so we&rsquo;ll convert each <code>option</code> <em>and</em> the <code>input</code> value itself to lower case with <code>toLowerCase()</code>. Next, we&rsquo;ll use <code>indexOf()</code> to check if the <code>input.value</code> exists in part or full in the <code>option</code>.</p>

<p>The <code>indexOf()</code> method returns <code>-1</code> if the item isn&rsquo;t found. Otherwise, it returns the index for where in the string the item starts. As long as it&rsquo;s not <code>-1</code>, we&rsquo;ll return the <code>option</code> to our new array.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">renderAutocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// Get potential options
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">potentialOptions</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">});</span>

	<span class="c1">// If there are no options, quit
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">potentialOptions</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>Next, we&rsquo;re going to create a list of items.</p>

<p>We&rsquo;ll setup our unordered list using <code>document.createElement()</code>. We&rsquo;ll give it a class of <code>autocomplete</code> and an <code>id</code> of <code>autocomplete-{datalist ID}</code>, using <code>getAttribute()</code> to get the input&rsquo;s <code>list</code> attribute.</p>

<p>Then, we&rsquo;ll through each potential option, create a list item with a button inside it (so that users can tab through the list with a keyboard), and our option as the value.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">renderAutocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// Get potential options
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">potentialOptions</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">});</span>

	<span class="c1">// If there are no options, quit
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">potentialOptions</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Create list of options
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">select</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;ul&#39;</span><span class="p">);</span>
	<span class="nx">select</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;autocomplete&#39;</span><span class="p">;</span>
	<span class="nx">select</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;autocomplete-&#39;</span> <span class="o">+</span> <span class="nx">input</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
	<span class="nx">potentialOptions</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">select</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="s1">&#39;&lt;li&gt;&lt;button&gt;&#39;</span> <span class="o">+</span> <span class="nx">option</span> <span class="o">+</span> <span class="s1">&#39;&lt;/button&gt;&lt;/li&gt;&#39;</span><span class="p">;</span>
	<span class="p">});</span>

<span class="p">};</span>
</code></pre></div>
<p>Now we can add our list to the DOM.</p>

<p>We&rsquo;ll look for an existing list in the DOM, and if one exists, remove it using the <code>Element.remove()</code> method. Then we&rsquo;ll use the <code>Element.after()</code> method to inject the element into the DOM after our input.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">renderAutocomplete</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

	<span class="c1">// Get potential options
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">potentialOptions</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">});</span>

	<span class="c1">// If there are no options, quit
</span><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nx">potentialOptions</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Create list of options
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">select</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;ul&#39;</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">listID</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
	<span class="nx">select</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;autocomplete&#39;</span><span class="p">;</span>
	<span class="nx">select</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;autocomplete-&#39;</span> <span class="o">+</span> <span class="nx">listID</span><span class="p">;</span>
	<span class="nx">potentialOptions</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">select</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="s1">&#39;&lt;li&gt;&lt;button&gt;&#39;</span> <span class="o">+</span> <span class="nx">option</span> <span class="o">+</span> <span class="s1">&#39;&lt;/button&gt;&lt;/li&gt;&#39;</span><span class="p">;</span>
	<span class="p">});</span>

	<span class="c1">// Inject into the DOM
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">existing</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;autocomplete-&#39;</span> <span class="o">+</span> <span class="nx">listID</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">existing</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">existing</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="nx">input</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">select</span><span class="p">);</span>

<span class="p">};</span>
</code></pre></div>
<p>Things are working, but this looks really ugly. Let&rsquo;s add some light styling to make it look nicer.</p>

<p>For the list itself, let&rsquo;s remove the bullets, and give a border and some light margin and padding tweaks. We don&rsquo;t want our buttons to look like buttons, we we&rsquo;ll remove any background or border, make them full width, and align the text to the left.</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="p">.</span><span class="nc">autocomplete</span> <span class="p">{</span>
	<span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#e5e5e5</span><span class="p">;</span>
	<span class="k">list-style</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
	<span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">padding</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
	<span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">autocomplete</span> <span class="nt">button</span> <span class="p">{</span>
	<span class="k">background</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
	<span class="k">border</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
	<span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
	<span class="k">text-align</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
	<span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>
<h2 id="update-the-input-when-the-user-selects-an-option">Update the input when the user selects an option</h2>

<p>When the user selects an item from the list, we need to actually update the field</p>

<p>Let&rsquo;s create a <code>click</code> event, and pass it into a <code>clickHandler()</code> function. This will fire when users hit <code>enter</code> or <code>return</code> on the button, too.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">clickHandler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<p>In the <code>clickHandler()</code> method we first want to check if the clicked item is a button in our <code>.autocomplete</code> list, and if not, quick.</p>

<p>Then, we&rsquo;ll look for the input that it belongs to. We&rsquo;ll do this by removing <code>autocomplete-</code> from the list ID, and using <code>querySelector()</code> to find the <code>input</code> whose <code>[list]</code> attribute value matches it.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">clickHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;.autocomplete&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">list</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Get input
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;input[list=&#34;&#39;</span> <span class="o">+</span> <span class="nx">list</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;autocomplete-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#34;]&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">input</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

<span class="p">};</span>
</code></pre></div>
<p>If we find an element, we can set its value to the clicked button&rsquo;s <code>textContent</code>. Then we&rsquo;ll use <code>Element.remove()</code> to remove the list of options from the DOM, and <code>focus()</code> to bring focus back to the input.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">clickHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;.autocomplete&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">list</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Get input
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;input[list=&#34;&#39;</span> <span class="o">+</span> <span class="nx">list</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;autocomplete-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#34;]&#39;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">input</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

	<span class="c1">// Update the input
</span><span class="c1"></span>	<span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>

	<span class="c1">// Remove the list from the DOM
</span><span class="c1"></span>	<span class="nx">list</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>

	<span class="c1">// Return focus to the input
</span><span class="c1"></span>	<span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>

<span class="p">};</span>
</code></pre></div>
<h2 id="hiding-the-list-of-options-on-blur">Hiding the list of options on blur</h2>

<p>There&rsquo;s one last missing piece. When the user navigates out of the input, or out of the list of options, we want to hide the list.</p>

<p>To do this, we&rsquo;ll listen for <code>blur</code> events and pass them into a <code>blurHandler()</code> helper. <code>blur</code> events don&rsquo;t normally bubble, so we&rsquo;ll need to set <code>useCapture</code> to <code>true</code> to use event delegation.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="nx">blurHandler</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
<p>In our <code>blurHandler()</code>, we first want to make sure the event was run in either an <code>input</code> with the <code>[list]</code> attribute, or a button in our <code>.autocomplete</code> list. If not, we&rsquo;ll bail.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">blurHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;input[list], .autocomplete&#39;</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>Since this gets called if the input blurs, we need to check if the list of autocomplete options is still in focus. If so, we don&rsquo;t have to do anything.</p>

<p>However, at the time the <code>blur</code> even fires, nothing has focus yet. So, we&rsquo;re going to wrap the rest of our code in a <code>setTimeout()</code> function that will run 1 ms later, after <code>focus</code> has changed.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">blurHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;input[list], .autocomplete&#39;</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="c1">// Do something...
</span><span class="c1"></span>	<span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p>We&rsquo;re going to see if the item currently in focus (<code>document.activeElement</code>) is inside our <code>.autocomplete</code> list. If so, we&rsquo;ll bail.</p>

<p>Otherwise, we&rsquo;ll get the currently open <code>.autocomplete</code> list and use <code>remove()</code> to remove it from the DOM.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">blurHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;input[list], .autocomplete&#39;</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;.autocomplete&#39;</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
		<span class="kd">var</span> <span class="nx">autocomplete</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.autocomplete&#39;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">autocomplete</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
		<span class="nx">autocomplete</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
	<span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<p><a href="http://jsfiddle.net/cferdinandi/x5mby01u/1/">Here&rsquo;s a demo you can play with</a> in Safari or some other unsupported browsers.</p>

<iframe width="100%" height="300" src="//jsfiddle.net/cferdinandi/x5mby01u/2/embedded/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>

<h2 id="browser-compatibility">Browser Compatibility</h2>

<p>This polyfill works back to at least IE9, but does require some additional polyfills of its own.</p>

<p>You&rsquo;ll need to add polyfills for:</p>

<ul>
<li><code>Array.forEach()</code> - <a href="https://vanillajstoolkit.com/polyfills/arrayforeach/">https://vanillajstoolkit.com/polyfills/arrayforeach/</a></li>
<li><code>NodeList.forEach()</code> - <a href="https://vanillajstoolkit.com/polyfills/nodelistforeach/">https://vanillajstoolkit.com/polyfills/nodelistforeach/</a></li>
<li><code>Array.from()</code> - <a href="https://vanillajstoolkit.com/polyfills/arrayfrom/">https://vanillajstoolkit.com/polyfills/arrayfrom/</a></li>
<li><code>Array.map()</code> - <a href="https://vanillajstoolkit.com/polyfills/arraymap/">https://vanillajstoolkit.com/polyfills/arraymap/</a></li>
<li><code>Array.filter()</code> - <a href="https://vanillajstoolkit.com/polyfills/arrayfilter/">https://vanillajstoolkit.com/polyfills/arrayfilter/</a></li>
<li><code>Element.after()</code> - <a href="https://vanillajstoolkit.com/polyfills/after/">https://vanillajstoolkit.com/polyfills/after/</a></li>
<li><code>Element.remove()</code> - <a href="https://vanillajstoolkit.com/polyfills/remove/">https://vanillajstoolkit.com/polyfills/remove/</a></li>
<li><code>Element.closest()</code> - <a href="https://vanillajstoolkit.com/polyfills/closest/">https://vanillajstoolkit.com/polyfills/closest/</a></li>
</ul>

<p>You can make life easier for yourself by using a polyfill service like <a href="https://polyfill.io">https://polyfill.io</a>, though you&rsquo;ll still need to polyfill <a href="https://vanillajstoolkit.com/polyfills/nodelistforeach/"><code>NodeList.forEach()</code></a> as that&rsquo;s not yet part of their package of polyfills.</p>


	</article>

	<br>
<aside>
	
<p><mark>🔥 <em><strong>FIRE SALE!</strong> To celebrate the launch of the <strong><a href="https://vanillajsguides.com/variables-functions-and-scope/">Pocket Guide video series on Functions, Variables, and Scope</a></strong>, you can <strong>take 50% off any guide or bundle</strong> with the code <strong><code>VAR50</code></strong> at checkout. This ends at midnight, so don't wait!</em></mark></p>


	<p><em>Have any questions or comments about this post? Email me at <a href="mailto:&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;">&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;</a> or contact me on Twitter at <a href="http://twitter.com/ChrisFerdinandi">@ChrisFerdinandi</a>.</em></p>

	<form action="https://gomakethings.us1.list-manage.com/subscribe/post?u=f2d244c0df42a0431bd08ddea&amp;id=aeaa9dd034" method="post" name="mc-embedded-subscribe-form" id="mailchimp-form" novalidate>
	<div class="row">
		<div class="grid-two-thirds">
			<div class="tarpit">
				<label for="name">If you're human, leave this blank</label>
				<input type="text" name="name" id="name" value="">
			</div>
			<div>
				<label class="screen-reader" for="mailchimp-email">Email Address</label>
				<input type="email" name="email" id="mailchimp-email" placeholder="Your email address..." required>
			</div>
			<input type="hidden" name="TbVktzD9dNZiQyZQ3Dk64w6L" value="WqJELdqqHHFTLUrEWJLu4DspKjeoBawWdWnZVVwti7RYpCyLr8WoWtm7UozshPy6">
			<input type="hidden" name="group[aaf6f8b9a3]" value="1">
			<input type="hidden" name="group[07afa3dcbc]" value="1">
		</div>
		<div class="grid-third">
			<button data-processing="Signing Up..." data-ready="Get Daily Developer Tips" class="btn btn-block" type="submit">Get Daily Developer Tips</button>
		</div>
	</div>
	<div id="mc-status"></div>
</form>
</aside>

			</div>
		</main>

		<footer class="container container-large">
			<hr class="margin-bottom">
			<nav class="tabindex nav-secondary" id="nav-secondary" tabindex="-1">
	<ul class="list-inline list-inline-responsive">
		<li><a href="https://gomakethings.com/about">About</a></li><li><a href="https://gomakethings.com/articles">Daily Tips</a></li><li><a href="https://gomakethings.com/resources">Learn JS</a></li>
	</ul>
</nav>
			<p class="text-small">Made with ❤️ in Massachusetts. Unless otherwise noted, all code is free to use under the <a href="https://gomakethings.com/mit">MIT License</a>.</p>
		</footer>

		<script>
			if ('querySelector' in document && 'addEventListener' in window && 'classList' in document.createElement('_')) {
				/*! gmt v1.16.0 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/go-make-things | Open Source Credits: https://github.com/toddmotto/fluidvids, http://prismjs.com, https://github.com/filamentgroup/loadJS/, https://github.com/filamentgroup/loadCSS, https://github.com/bramstein/fontfaceobserver */
!(function(e,t,n){"use strict";var i=t.querySelectorAll(".edd-buy-now-button"),o=function(e){e.target.classList.contains("edd-buy-now-button")&&(0!==e.button||e.metaKey||e.ctrlKey||(e.target.innerHTML="Adding to cart...",e.target.classList.add("disabled")))};i.length>0&&t.addEventListener("click",o,!1)})(window,document),(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t:e.fluidvids=t()})(this,(function(){"use strict";var e={selector:["iframe"],players:["www.youtube.com","player.vimeo.com"]},t=[".fluidvids {","width: 100%; max-width: 100%; position: relative;","}",".fluidvids-item {","position: absolute; top: 0px; left: 0px; width: 100%; height: 100%;","}"].join(""),n=document.head||document.getElementsByTagName("head")[0],i=function(t){return new RegExp("^(https?:)?//(?:"+e.players.join("|")+").*$","i").test(t)},o=function(e,t){return parseInt(e,10)/parseInt(t,10)*100+"%"},a=function(e){if(i(e.src)&&!e.getAttribute("data-fluidvids")){var t=document.createElement("div");e.parentNode.insertBefore(t,e),e.className+=(e.className?" ":"")+"fluidvids-item",e.setAttribute("data-fluidvids","loaded"),t.className+="fluidvids",t.style.paddingTop=o(e.height,e.width),t.appendChild(e)}},r=function(){var e=document.createElement("div");e.innerHTML="<p>x</p><style>"+t+"</style>",n.appendChild(e.childNodes[1])};return e.render=function(){for(var t=document.querySelectorAll(e.selector.join()),n=t.length;n--;)a(t[n])},e.init=function(t){for(var n in t)e[n]=t[n];e.render(),r()},e}));var addHeadingLinks=function(e,t,n){"use strict";if(e){var i=document.querySelectorAll(e);t=t||"#",n=n||"anchor-link";for(var o=0;o<i.length;o++)i[o].id&&(i[o].innerHTML+=' <a class="'+n+'" href="#'+i[o].id+'">'+t+"</a>")}},mailchimp=function(e){"use strict";var t=document.querySelector("#mailchimp-form");if(t){var n=t.querySelector("#mailchimp-email");if(n){var i=t.querySelector("#mc-status"),o={empty:"Please provide an email address.",notEmail:"Please use a valid email address.",success:"Success! Thanks for inviting me to your inbox."},a=function(e){for(var t=[],n=0;n<e.elements.length;n++){var i=e.elements[n];i.name&&!i.disabled&&"file"!==i.type&&"reset"!==i.type&&"submit"!==i.type&&"button"!==i.type&&(("checkbox"!==i.type&&"radio"!==i.type||i.checked)&&t.push(encodeURIComponent(i.name)+"="+encodeURIComponent(i.value)))}return t.join("&")},r=function(){i&&(i.textContent="",i.className="",n.className="",n.removeAttribute("aria-describedby"))},c=function(e,t){i&&(i.textContent=e,t?(i.className="success-message",i.setAttribute("tabindex","-1"),i.focus()):(i.className="error-message",n.className="error",n.setAttribute("aria-describedby","mc-status"),n.focus()))},s=function(){var e=t.querySelector("[data-processing]");e&&(e.setAttribute("data-original",e.innerHTML),e.setAttribute("disabled","disabled"),e.innerHTML=e.getAttribute("data-processing"))},u=function(){var e=t.querySelector("[data-processing]");e&&(e.removeAttribute("disabled"),e.innerHTML=e.getAttribute("data-original"))},l=function(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){var t=200===n.status,i=JSON.parse(n.responseText);t?c(o.success,t):c(i.message,t),u(),e&&"function"==typeof e&&e(i)}},n.open("POST","https://gomakethings.com/checkout/wp-json/gmt-mailchimp/v1/subscribe?"+t),n.send()},d=function(){s(),l(a(t))},f=function(){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$/.test(n.value)},m=function(){return n.value.length<1?(c(o.empty),!1):!!f()||(c(o.notEmail),!1)},x=function(e){e.preventDefault(),r(),m()&&d()};t.addEventListener("submit",x,!1)}}};if(window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,n=(this.document||this.ownerDocument).querySelectorAll(e),i=this;do{for(t=n.length;--t>=0&&n.item(t)!==i;);}while(t<0&&(i=i.parentElement));return i}),(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-e)),a=window.setTimeout((function(){t(i+o)}),o);return e=i+o,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),(function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e)})):"object"==typeof exports?module.exports=t(e):e.SmoothScroll=t(e)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(e){"use strict";var t="querySelector"in document&&"addEventListener"in e&&"requestAnimationFrame"in e&&"closest"in e.Element.prototype,n={ignore:"[data-scroll-ignore]",header:null,speed:500,offset:0,easing:"easeInOutCubic",customEasing:null,before:function(){},after:function(){}},i=function(){for(var e={},t=0,n=arguments.length;t<n;t++){var i=arguments[t];!(function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(i)}return e},o=function(t){return parseInt(e.getComputedStyle(t).height,10)},a=function(e){"#"===e.charAt(0)&&(e=e.substr(1));for(var t,n=String(e),i=n.length,o=-1,a="",r=n.charCodeAt(0);++o<i;){if(0===(t=n.charCodeAt(o)))throw new InvalidCharacterError("Invalid character: the input contains U+0000.");t>=1&&t<=31||127==t||0===o&&t>=48&&t<=57||1===o&&t>=48&&t<=57&&45===r?a+="\\"+t.toString(16)+" ":a+=t>=128||45===t||95===t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122?n.charAt(o):"\\"+n.charAt(o)}return"#"+a},r=function(e,t){var n;return"easeInQuad"===e.easing&&(n=t*t),"easeOutQuad"===e.easing&&(n=t*(2-t)),"easeInOutQuad"===e.easing&&(n=t<.5?2*t*t:(4-2*t)*t-1),"easeInCubic"===e.easing&&(n=t*t*t),"easeOutCubic"===e.easing&&(n=--t*t*t+1),"easeInOutCubic"===e.easing&&(n=t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1),"easeInQuart"===e.easing&&(n=t*t*t*t),"easeOutQuart"===e.easing&&(n=1- --t*t*t*t),"easeInOutQuart"===e.easing&&(n=t<.5?8*t*t*t*t:1-8*--t*t*t*t),"easeInQuint"===e.easing&&(n=t*t*t*t*t),"easeOutQuint"===e.easing&&(n=1+--t*t*t*t*t),"easeInOutQuint"===e.easing&&(n=t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t),e.customEasing&&(n=e.customEasing(t)),n||t},c=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},s=function(e,t,n){var i=0;if(e.offsetParent)do{i+=e.offsetTop,e=e.offsetParent}while(e);return i=Math.max(i-t-n,0)},u=function(e){return e?o(e)+e.offsetTop:0},l=function(t,n,i){i||(t.focus(),document.activeElement.id!==t.id&&(t.setAttribute("tabindex","-1"),t.focus(),t.style.outline="none"),e.scrollTo(0,n))},d=function(t){return!!("matchMedia"in e&&e.matchMedia("(prefers-reduced-motion)").matches)};return function(o,f){var m,x,h,p,g,v,b,y={};y.cancelScroll=function(){cancelAnimationFrame(b)},y.animateScroll=function(t,o,a){var d=i(m||n,a||{}),f="[object Number]"===Object.prototype.toString.call(t),x=f||!t.tagName?null:t;if(f||x){var h=e.pageYOffset;d.header&&!p&&(p=document.querySelector(d.header)),g||(g=u(p));var v,b,w,A=f?t:s(x,g,parseInt("function"==typeof d.offset?d.offset():d.offset,10)),S=A-h,E=c(),q=0,L=function(n,i){var a=e.pageYOffset;if(n==i||a==i||(h<i&&e.innerHeight+a)>=E)return y.cancelScroll(),l(t,i,f),d.after(t,o),v=null,!0},T=function(t){v||(v=t),q+=t-v,b=q/parseInt(d.speed,10),b=b>1?1:b,w=h+S*r(d,b),e.scrollTo(0,Math.floor(w)),L(w,A)||(e.requestAnimationFrame(T),v=t)};0===e.pageYOffset&&e.scrollTo(0,0),d.before(t,o),y.cancelScroll(),e.requestAnimationFrame(T)}};var w=function(e){x&&(x.id=x.getAttribute("data-scroll-id"),y.animateScroll(x,h),x=null,h=null)},A=function(t){if(!d()&&0===t.button&&!t.metaKey&&!t.ctrlKey&&(h=t.target.closest(o))&&"a"===h.tagName.toLowerCase()&&!t.target.closest(m.ignore)&&h.hostname===e.location.hostname&&h.pathname===e.location.pathname&&/#/.test(h.href)){var n;try{n=a(decodeURIComponent(h.hash))}catch(e){n=a(h.hash)}if("#"===n){t.preventDefault(),x=document.body;var i=x.id?x.id:"smooth-scroll-top";return x.setAttribute("data-scroll-id",i),x.id="",void(e.location.hash.substring(1)===i?w():e.location.hash=i)}x=document.querySelector(n),x&&(x.setAttribute("data-scroll-id",x.id),x.id="",h.hash===e.location.hash&&(t.preventDefault(),w()))}},S=function(e){v||(v=setTimeout((function(){v=null,g=u(p)}),66))};return y.destroy=function(){m&&(document.removeEventListener("click",A,!1),e.removeEventListener("resize",S,!1),y.cancelScroll(),m=null,x=null,h=null,p=null,g=null,v=null,b=null)},y.init=function(o){t&&(y.destroy(),m=i(n,o||{}),p=m.header?document.querySelector(m.header):null,g=u(p),document.addEventListener("click",A,!1),e.addEventListener("hashchange",w,!1),p&&e.addEventListener("resize",S,!1))},y.init(f),y}})),fluidvids.init({selector:["iframe","object"],players:["www.youtube.com","player.vimeo.com","www.slideshare.net","www.hulu.com","videopress.com/embed/"]}),document.querySelector('a[href*="#"]'))var scroll=new SmoothScroll('a[href*="#"]');document.querySelector("#mailchimp-form")&&mailchimp((function(e){200===e.code&&(window.location.href="/newsletter-success")})),(document.body.matches(".type-articles.page-single")||document.body.matches("#page-54a32daa7699b0585cab71188bd8c152"))&&addHeadingLinks("h2, h3, h4, h5, h6","#","link-no-underline");
				
			}
			
			var _paq = _paq || [];
			
			_paq.push(['trackPageView']);
			_paq.push(['enableLinkTracking']);
			(function() {
				var u="//analytics.gomakethings.com/";
				_paq.push(['setTrackerUrl', u+'piwik.php']);
				_paq.push(['setSiteId', '1']);
				var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
				g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
			})();
		</script>
		<noscript><p><img src="//analytics.gomakethings.com/piwik.php?idsite=1&rec=1" style="border:0;" alt="" /></p></noscript>
	</body>
</html>