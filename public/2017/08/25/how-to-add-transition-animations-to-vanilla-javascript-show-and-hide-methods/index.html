<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>How to add transition animations to vanilla JavaScript show and hide methods | Go Make Things</title>
		

		
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
		
		<link rel="shortcut icon" href="https://gomakethings.com/img/favicon.ico">
		<link rel="icon" sizes="16x16 32x32" href="https://gomakethings.com/img/favicon.ico">

		
		
		<link rel="alternate" type="application/rss+xml" title="Go Make Things RSS Feed" href="http://feeds.feedburner.com/GoMakeThings">
		<link rel="feed" type="application/rss+xml" title="Go Make Things RSS Feed" href="http://feeds.feedburner.com/GoMakeThings">

		
		<link rel="stylesheet" href="https://gomakethings.com/css/main.min.1.1.0.css">

		
		<script src="https://gomakethings.com/js/detects.min.1.1.0.js"></script>
		<script>
			;(function () {
				var css = 'https://fonts.googleapis.com/css?family=PT+Serif:400,400i,700,700i';
				if (getCookie('fontsLoaded')) {
					loadCSS(css);
					document.documentElement.className += 'fonts-loaded';
				} else {
					loadCSS(css);
					var font = new FontFaceObserver('PT Serif');
					font.load().then(function () {
						var expires = new Date(+new Date() + (7 * 24 * 60 * 60 * 1000)).toUTCString();
						document.cookie = 'fontsLoaded=true; expires=' + expires;
						document.documentElement.className += ' fonts-loaded';
					});
				}
			})();
		</script>
	</head>

	<body>

		<div class="container container-large">

	
	<a class="screen-reader screen-reader-focusable" href="#main">Skip to main content</a>

	
	<a class="screen-reader screen-reader-focusable" href="mailto:&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;?subject=Go%20Make%20Things:%20Accessibility%20Feedback">Accessibility Feedback</a>

</div>

		<header class="container container-large margin-bottom-large">
	<nav class="nav-wrap">
		<a class="logo" href="https://gomakethings.com">
			<svg xmlns="http://www.w3.org/2000/svg" style="height:.8em;width:.8em" viewBox="0 0 16 16"><title></title><path fill="currentColor" d="M14 9v2.066c-1.258 1.285-3.016 2.526-5 2.852V8.001h3v-1L9 5.83A3.001 3.001 0 0 0 8 .001 3 3 0 0 0 7 5.83L4 7.001v1h3v5.917c-1.984-.326-3.742-1.567-5-2.852V9H0v1c0 2 4 6 8 6s8-4 8-6V9h-2zM9 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>
			Go Make Things
		</a>
		<div class="nav-menu" id="nav-menu">
			<ul class="nav">
				<li><a href="https://gomakethings.com/about">About</a></li><li><a href="https://gomakethings.com/guides">Guides</a></li><li><a href="https://gomakethings.com/courses">Courses</a></li><li><a href="https://gomakethings.com/resources">Resources</a></li><li><a href="https://gomakethings.com/articles">Daily Tips</a></li>
			</ul>
		</div>
	</nav>
</header>

		<main id="main" tabindex="-1">

			<div class="container">

	<article>

	
	<h1><span class="title">How to add transition animations to vanilla JavaScript show and hide methods</span></h1>
	

	

<p>Yesterday, we looked at <a href="/how-to-show-and-hide-elements-with-vanilla-javascript/">how to show and hide elements with vanilla JavaScript</a>.</p>

<p>To recap, we can either add an inline <code>display</code> style with the <code>style</code> property, or toggle a class that controls visibility using <code>classList</code>.</p>

<p>Today, let&rsquo;s learn how to add transitions.</p>

<h2 id="adding-transitions">Adding transitions</h2>

<p>Adding transitions is where things get just a bit more complicated.</p>

<p>Let&rsquo;s say you wanted to animate the expansion or collapse of your content like jQuery does. You might try adding a <code>height</code> property of <code>0</code>, and changing it to <code>auto</code> when <code>.is-visible</code> is added.</p>

<pre><code class="language-lang-css">.toggle-content {
	display: none;
	height: 0;
	transition: height 350ms ease-in-out;
}

.toggle-content.is-visible {
	display: block;
	height: auto;
}
</code></pre>

<p>Unfortunately, that won&rsquo;t work. CSS transitions require fixed values, and will not animate <code>auto</code> values.</p>

<p>One commonly proposed solution is to use <code>max-height</code> instead of height, and set the expanded value to something really large like <code>999em</code>.</p>

<pre><code class="language-lang-css">.toggle-content {
	display: none;
	max-height: 0;
	overflow: hidden;
	transition: max-height 350ms ease-in-out;
}

.toggle-content.is-visible {
	display: block;
	max-height: 999em;
}
</code></pre>

<p><a href="https://jsfiddle.net/cferdinandi/qgpxvhhb/10/">If you check out this demo, you&rsquo;ll notice that the <code>max-height</code> isn&rsquo;t animating.</a></p>

<p>The problem is with the <code>display</code> property.</p>

<p>Because the <code>display</code> property is set to <code>none</code>, and then changes to <code>block</code>, the change in <code>max-height</code> is never triggered in the browser. From the browser&rsquo;s perspective, it has no set <code>max-height</code> until it&rsquo;s displayed.</p>

<p>If we remove the <code>display</code> property, you&rsquo;ll notice it works, sort of (<a href="https://jsfiddle.net/cferdinandi/qgpxvhhb/17/">here&rsquo;s a demo</a>).</p>

<pre><code class="language-lang-css">.toggle-content {
	max-height: 0;
	overflow: hidden;
	transition: max-height 2000ms ease-in-out;
}

.toggle-content.is-visible {
	max-height: 999em;
}
</code></pre>

<p>There are two problems with this approach.</p>

<ol>
<li>The animation is barely visible.</li>
<li>There&rsquo;s a weird lag before the element collapses.</li>
</ol>

<p>Both of these are caused by large <code>max-height</code> property with the <code>.is-visible</code> class.</p>

<p>Regardless of the rendered height of the element, the browser runs the animation over the full height of the <code>max-height</code>.</p>

<p>For short pieces of content, the animation is barely perceptible because it happens so fast. And when closing the content, the animation first runs over the non-existent extra height in that <code>max-height</code> before getting to the real content.</p>

<p>You could make that height smaller, but you run the risk of having content clipped if it&rsquo;s too tall for the container on smaller viewports. And there&rsquo;s accessibility issues with having content with a <code>max-height</code> of <code>0</code> but still displayed in the DOM.</p>

<p>We need a more elegant solution.</p>

<h2 id="using-javascript-to-dynamically-calculate-our-height">Using JavaScript to dynamically calculate our height</h2>

<p>To make this all work, we want to do two things:</p>

<ol>
<li>Dynamically calculate the height of our element, so that the browser has an actually <code>height</code> value to animate. We&rsquo;ll <a href="/two-ways-to-set-an-elements-css-with-vanilla-javascript/">add this inline</a> to our element</li>
<li>Delay changing the <code>display</code> property until after the animation is complete.</li>
</ol>

<p>First, let&rsquo;s update our CSS.</p>

<p>We&rsquo;ll add the <code>display</code> back. We&rsquo;ll switch <code>max-height</code> back to <code>height</code>, and give it a value of <code>auto</code> when the content is visible. We&rsquo;ll be using JavaScript to add this as content-specific inline CSS for us.</p>

<pre><code class="language-lang-css">.toggle-content {
	display: none;
	height: 0;
	overflow: hidden;
	transition: height 350ms ease-in-out;
}

.toggle-content.is-visible {
	display: block;
	height: auto;
}
</code></pre>

<h2 id="showing-an-element">Showing an element</h2>

<p>To show an element, we first need to get it&rsquo;s natural height (it&rsquo;s height when it&rsquo;s not hidden). Let&rsquo;s create a function named <code>getHeight()</code> to handle this for us.</p>

<p>First, we&rsquo;ll set the element&rsquo;s <code>display</code> to <code>block</code>.</p>

<p>Then we&rsquo;ll get it&rsquo;s height using <code>scrollHeight</code>, which tells you the height of an element&rsquo;s content, and store it to a variable. This returns an integer, so we&rsquo;ll need to add <code>px</code> to the end to use with our inline style.</p>

<p>Finally, we&rsquo;ll hide our element again by removing the <code>display</code> property, and return our <code>height</code> value.</p>

<pre><code class="language-lang-javascript">// Get the natural height of the element
var getHeight = function () {
	elem.style.display = 'block'; // Make it visible
	var height = elem.scrollHeight + 'px'; // Get it's height
	elem.style.display = ''; //  Hide it again
	return height;
};
</code></pre>

<p>Even though we&rsquo;re showing and then re-hiding our content, it never shows visibly for users because the function runs so quickly (just a few milliseconds) and thus never actually renders visually in the DOM.</p>

<p>Next, we want to do three things:</p>

<ol>
<li>Actually run <code>getHeight</code> to calculate the element&rsquo;s natural height.</li>
<li>Add the <code>.is-visible</code> class to our element to update it&rsquo;s <code>display</code> property.</li>
<li>Set it&rsquo;s <code>height</code> as an inline property.</li>
</ol>

<pre><code class="language-lang-javascript">var show = function (elem) {

	// Get the natural height of the element
	var getHeight = function () {
		elem.style.display = 'block'; // Make it visible
		var height = elem.scrollHeight + 'px'; // Get it's height
		elem.style.display = ''; //  Hide it again
		return height;
	};

	var height = getHeight(); // Get the natural height
	elem.classList.add('is-visible'); // Make the element visible
	elem.style.height = height; // Update the max-height

};
</code></pre>

<p>There&rsquo;s one last thing we should do: remove the inline <code>height</code> property after the animation is complete. If we leave it and someone resizes the browser, the content container could be too tall, or worse, too short and clip the content.</p>

<p>We&rsquo;ll use <code>setTimeout()</code> to create a function that we run <em>after</em> our animation finishes. The first argument in <code>setTimeout()</code> is our function, where we&rsquo;ll remove the inline <code>height</code> property. The second is how far out, in milliseconds, to run that function.</p>

<pre><code class="language-lang-javascript">var show = function (elem) {

	// Get the natural height of the element
	var getHeight = function () {
		elem.style.display = 'block'; // Make it visible
		var height = elem.scrollHeight + 'px'; // Get it's height
		elem.style.display = ''; //  Hide it again
		return height;
	};

	var height = getHeight(); // Get the natural height
	elem.classList.add('is-visible'); // Make the element visible
	elem.style.height = height; // Update the max-height

	// Once the transition is complete, remove the inline max-height so the content can scale responsively
	window.setTimeout(function () {
		elem.style.height = '';
	}, 350);

};
</code></pre>

<p>So far, so good!</p>

<h2 id="hiding-and-element">Hiding and element</h2>

<p>Visible elements, once animated, have a <code>height</code> of <code>auto</code>. To animate hiding them, we need to give them a fixed height to animate down to <code>0</code>.</p>

<p>Let&rsquo;s again calculate the natural height of the element with <code>scrollHeight</code> and add it as an inline style.</p>

<pre><code class="language-lang-javascript">var hide = function (elem) {

	// Give the element a height to change from
	elem.style.height = elem.scrollHeight + 'px';

};
</code></pre>

<p>Next, we want to set our <code>height</code> <em>back</em> to <code>0</code>. <em>But</em>, if we run it too quickly, the browser won&rsquo;t detect the change at all and won&rsquo;t run. We&rsquo;ll use <code>setTimeout()</code> with a 1 millisecond delay to make sure the change registers.</p>

<pre><code class="language-lang-javascript">var hide = function (elem) {

	// Give the element a height to change from
	elem.style.height = elem.scrollHeight + 'px';

	// Set the height back to 0
	window.setTimeout(function () {
		elem.style.height = '0';
	}, 1);

};
</code></pre>

<p>When the animation completes, we can remove our <code>.is-visible</code> class to set <code>display</code> to <code>none</code> again.</p>

<pre><code class="language-lang-javascript">var hide = function (elem) {

	// Give the element a height to change from
	elem.style.height = elem.scrollHeight + 'px';

	// Set the height back to 0
	window.setTimeout(function () {
		elem.style.height = '0';
	}, 1);

	// When the transition is complete, hide it
	window.setTimeout(function () {
		elem.classList.remove('is-visible');
	}, 350);

};
</code></pre>

<h2 id="toggling-an-element-s-visibility">Toggling an element&rsquo;s visibility</h2>

<p>The last thing we need to do is add a method to toggle visibility.</p>

<p>For this one, we&rsquo;ll check to see if our element has the <code>.is-visible</code> class. If it does, it&rsquo;s already visible and we&rsquo;ll run our <code>hide()</code> method. Otherwise, we&rsquo;ll run our <code>show()</code> method.</p>

<pre><code class="language-lang-javascript">var toggle = function (elem, timing) {

	// If the element is visible, hide it
	if (elem.classList.contains('is-visible')) {
		hide(elem);
		return;
	}

	// Otherwise, show it
	show(elem);

};
</code></pre>

<h2 id="putting-it-all-together">Putting it all together</h2>

<p>Here&rsquo;s the whole thing together.</p>

<pre><code class="language-lang-javascript">// Show an element
var show = function (elem) {

	// Get the natural height of the element
	var getHeight = function () {
		elem.style.display = 'block'; // Make it visible
		var height = elem.scrollHeight + 'px'; // Get it's height
		elem.style.display = ''; //  Hide it again
		return height;
	};

	var height = getHeight(); // Get the natural height
	elem.classList.add('is-visible'); // Make the element visible
	elem.style.height = height; // Update the max-height

	// Once the transition is complete, remove the inline max-height so the content can scale responsively
	window.setTimeout(function () {
		elem.style.height = '';
	}, 350);

};

// Hide an element
var hide = function (elem) {

	// Give the element a height to change from
	elem.style.height = elem.scrollHeight + 'px';

	// Set the height back to 0
	window.setTimeout(function () {
		elem.style.height = '0';
	}, 1);

	// When the transition is complete, hide it
	window.setTimeout(function () {
		elem.classList.remove('is-visible');
	}, 350);

};

// Toggle element visibility
var toggle = function (elem, timing) {

	// If the element is visible, hide it
	if (elem.classList.contains('is-visible')) {
		hide(elem);
		return;
	}

	// Otherwise, show it
	show(elem);

};
</code></pre>

<p><a href="https://jsfiddle.net/cferdinandi/qgpxvhhb/18/">Check out a working demo here.</a></p>


</article>

	<br>
<aside>
	<p><mark>🚀 <em><strong>Make 2018 the year you master JavaScript!</strong> My <a href="https://gomakethings.com/guides/">pocket guides</a> and <a href="https://gomakethings.com/courses/">mini courses</a> are short, focused, and made for beginners. You can do this!</em></mark></p>

	<p><em>Have any questions or comments about this post? Email me at <a href="mailto:&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;">&#099;&#104;&#114;&#105;&#115;&#064;&#103;&#111;&#109;&#097;&#107;&#101;&#116;&#104;&#105;&#110;&#103;&#115;&#046;&#099;&#111;&#109;</a> or contact me on Twitter at <a href="http://twitter.com/ChrisFerdinandi">@ChrisFerdinandi</a>.</em></p>

	<form action="https://gomakethings.us1.list-manage.com/subscribe/post?u=f2d244c0df42a0431bd08ddea&amp;id=aeaa9dd034" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank">
	<div class="row">
		<div class="grid-two-thirds">
			<div class="tarpit">
				<label for="name">Don't fill this field in</label>
				<input type="text" name="b_f2d244c0df42a0431bd08ddea_aeaa9dd034" id="name" value="">
			</div>
			<div>
				<label class="screen-reader" for="mce-EMAIL">Email Address</label>
				<input type="email" name="EMAIL" id="mce-EMAIL" title="The domain portion of the email address is invalid (the part after the @)." pattern="^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$" placeholder="Your email address..." required>
			</div>
			<input type="hidden" value="16" name="group[6981][16]" id="mce-group[6981]-6981-0">
		</div>
		<div class="grid-third">
			<button class="btn btn-block" type="submit">Get Daily Developer Tips</button>
		</div>
	</div>
	<div class="mc-status"></div>
</form>
</aside>

			</div>
		</main>

		<footer class="container container-large">
			<hr class="margin-bottom">
			<nav class="tabindex nav-secondary" id="nav-secondary" tabindex="-1">
	<ul class="list-inline list-inline-responsive">
		<li><a href="https://gomakethings.com/about">About</a></li><li><a href="https://gomakethings.com/guides">Guides</a></li><li><a href="https://gomakethings.com/courses">Courses</a></li><li><a href="https://gomakethings.com/resources">Resources</a></li><li><a href="https://gomakethings.com/articles">Daily Tips</a></li>
	</ul>
</nav>
			<p class="text-small">Made with ❤️ in Massachussets. Unless otherwise noted, all code is free to use under the <a href="/mit">MIT License</a>.</p>
		</footer>

		<script src="https://gomakethings.com/js/loadJS.min.1.1.0.js"></script>
		<script>
			if ('querySelector' in document && 'addEventListener' in window) {
				loadJS('https:\/\/gomakethings.com\/js\/main.min.1.1.0.js');
			}
		</script>
	</body>
</html>